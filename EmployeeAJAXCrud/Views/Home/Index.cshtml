@{
    ViewData["Title"] = "Home Page";
}
<h5> <i class="bi bi-person-fill"></i> basic employee information</h5>
<button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#newModal"><i class="bi bi-plus-circle"></i> New</button>
<div class="row py-3">
    <div class="col-12">
        <table id="tablePerson" class="table table-bordered table-dark table-striped py-3">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Fullname</th>
                    <th>Position</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody class="tbody">
            </tbody>
        </table>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="newModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Add New</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label">Person #</label>
                    <input type="text" class="form-control" disabled style="max-width:110px;">
                </div>
                <div class="mb-3">
                    <label class="form-label">Full Name</label>
                    <input id="fullname" type="text" class="form-control">
                </div>
                <div class="mb-3">
                    <label class="form-label">Position</label>
                    <input id="position" type="text" class="form-control">
                </div>
            </div>
            <div class="modal-footer">
                <a class="btn btn-secondary" data-bs-dismiss="modal">Close</a>
                <a href="#" id="Save" class="btn btn-primary">Add</a>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Edit</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label">Person #</label>
                    <input id="editID" type="text" class="form-control" disabled style="max-width:110px;">
                </div>
                <div class="mb-3">
                    <label class="form-label">Full Name</label>
                    <input id="editFullname" type="text" class="form-control">
                </div>
                <div class="mb-3">
                    <label class="form-label">Position</label>
                    <input id="editPosition" type="text" class="form-control">
                </div>
            </div>
            <div class="modal-footer">
                <a class="btn btn-secondary" data-bs-dismiss="modal">Close</a>
                <a href="#" id="Update" class="btn btn-primary">Save changes</a>
            </div>
        </div>
    </div>
</div>
<script>

    $(document).ready(function() {
        alert('page load successfully.');
        LoadData();
    });

    function LoadData() {
        $.ajax({
            url: "/Home/GetAll",
            type: "GET",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function(data) {
                var html = '';
                $.each(data, function(key, item) {
                    html += '<tr>';
                    html += '<td>' + item.id + '</td>';
                    html += '<td>' + item.fullname + '</td>';
                    html += '<td>' + item.position + '</td>';
                    html += '<td><a href="" onclick="return GetOne(' + item.id + ')" data-bs-toggle="modal" data-bs-target="#editModal">Edit</a> | <a href="" onclick="return Delete(' + item.id + ')" >Delete</a></td>';
                    html += '</tr>';
                });
                $('.tbody').html(html);
            },
            error: function(errormessage) {
                alert(errormessage.responseText);
            }
        });
    }
    function GetOne(id) {
        $.ajax({
            url: "/Home/GetOne/" + id,
            typr: "GET",
            contentType: "application/json;charset=UTF-8",
            dataType: "json",
            data: { id: id },
            success: function(data) {
                $('#editID').val(data.id);
                $('#editFullname').val(data.fullname);
                $('#editPosition').val(data.position);
                $('#editModal').modal('show');
            },
            error: function(errormessage) {
                alert(errormessage.responseText);
            }
        });
        return false;
    }
    function Delete(id) {
        if (confirm('Are you sure you want to delete this thing into the database?')) {
            $.ajax({
                url: "/Home/Remove/" + id,
                typr: "GET",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                data: { id: id },
                success: function(data) {
                    LoadData();
                },
                error: function(errormessage) {
                    alert(errormessage.responseText);
                }
            });

        } else {

        }

        return false;
    }

    $('#Save').click(function() {
        var fullname = $("#fullname").val();
        var position = $("#position").val();

        var pdata = new Object();
        pdata.fullname = fullname;
        pdata.position = position;

        $.ajax({
            type: 'POST',
            url: '/Home/Save',
            data: pdata,
            success(data) {
                if (data == 'pass') {
                    $('#newModal').modal('hide');  
                    LoadData();
                }
                else {
                    alert('failed');
                }
            }
        });
    })
    $('#Update').click(function() {
        var id = $("#editID").val();
        var fullname = $("#editFullname").val();
        var position = $("#editPosition").val();

        var pdata = new Object();
        pdata.id = id;
        pdata.fullname = fullname;
        pdata.position = position;

        $.ajax({
            type: 'POST',
            url: '/Home/Save',
            data: pdata,
            success(data) {
                if (data == 'pass') {
                    $('#editModal').modal('hide');  
                    LoadData();
                }
                else {
                    alert('failed');
                }
            }
        });
    })



</script>